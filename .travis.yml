language: shell
install: true

matrix:
  include:

  - name: "MSVC on Windows"
    os: windows
    # MSVC is already installed on Travis, keep it here just in case we need to use it later
    #install:
    #- choco install visualstudio2017-workload-vctools -y --package-parameters "--no-includeRecommended --add Microsoft.VisualStudio.Component.VC.x86.amd64 --add Microsoft.VisualStudio.Component.Windows10SDK"
    script:
    # test if meow_hash.h compiles as C
    - touch test.c
    - cmd.exe /C '"C:\Program Files (x86)\Microsoft Visual Studio\2017\BuildTools\VC\Auxiliary\Build\vcvarsall.bat" amd64 && cl.exe /c /FImeow_intrinsics.h /FImeow_hash.h test.c'
    # build & test
    - cmd.exe /C '"C:\Program Files (x86)\Microsoft Visual Studio\2017\BuildTools\VC\Auxiliary\Build\vcvarsall.bat" amd64 && build.bat'
    - build_msvc/meow_test.exe
    - build_msvc/meow_example.exe
    - ( sleep 60 ; taskkill /f /im notepad.exe ) & 
    - notepad.exe
    - tasklist

#  - name: "gcc on Windows"
#    os: windows
#    env:
#    - CC="/c/ProgramData/chocolatey/lib/mingw/tools/install/mingw64/bin/x86_64-w64-mingw32-gcc"
#    - CXX="/c/ProgramData/chocolatey/lib/mingw/tools/install/mingw64/bin/x86_64-w64-mingw32-g++"
#    install:
#    - choco upgrade mingw -y
#    - ${CC} --version
#    script:
#    # test if meow_hash.h compiles as C
#    - touch test.c
#    - ${CC} -c -mssse3 -maes -include meow_intrinsics.h -include meow_hash.h test.c
#    # build & test
#    - ./build.sh
#    - build/meow_test.exe
#    - build/meow_example.exe

 
